# 要件定義書

## はじめに

このドキュメントは、新年会用Bingo抽選アプリケーションの要件を定義します。

## 用語集

- **Bingoシステム**: 新年会などのイベントで使用する、ローカル環境完結型のBingo抽選アプリケーション
- **抽選エンジン**: ビンゴ番号をランダムに選択し、重複を防ぐロジックを持つコンポーネント
- **景品マスタ**: CSV形式で管理される景品情報のデータセット
- **ゲーム状態**: 抽選済み番号、景品の当選状態、BGM設定などを含むアプリケーションの現在の状態
- **ルーレット演出**: react-custom-rouletteを使用した抽選時のアニメーション表示

## 要件

### 要件1: アプリケーション起動とメニュー操作

**ユーザーストーリー:** 進行役として、アプリケーションを起動してゲームを開始または再開したい

#### 受入基準

1. Bingoシステムは、起動時にStart画面を表示すること
2. 「はじめから」ボタンがクリックされたとき、Bingoシステムは、ゲーム状態を初期化してGame画面へ遷移すること
3. 「続きから」ボタンがクリックされたとき、Bingoシステムは、localStorageから前回のゲーム状態を読み込んでGame画面へ遷移すること
4. 「設定」ボタンがクリックされたとき、Bingoシステムは、Setting画面へ遷移すること
5. localStorageに保存されたゲーム状態が存在しない場合、かつ「続きから」ボタンがクリックされたとき、Bingoシステムは、新規ゲームとして開始すること

### 要件2: BGM制御

**ユーザーストーリー:** 進行役として、会場の雰囲気に合わせてBGMのオン・オフを切り替えたい

#### 受入基準

1. Bingoシステムは、Start画面の右上にBGMトグルアイコンを表示すること
2. BGMトグルアイコンがクリックされたとき、Bingoシステムは、BGMの再生状態を切り替えること
3. Bingoシステムは、BGMのオン・オフ状態をlocalStorageへ保存すること
4. アプリケーションが起動されたとき、Bingoシステムは、localStorageからBGM設定を読み込むこと
5. Bingoシステムは、@mui/icons-materialの音量アイコンを使用してBGM状態を視覚的に表示すること

### 要件3: ビンゴ番号抽選

**ユーザーストーリー:** 進行役として、重複のないビンゴ番号を抽選して参加者へ提示したい

#### 受入基準

1. 抽選エンジンは、1から75の範囲でビンゴ番号を管理すること
2. 抽選ボタンがクリックされたとき、抽選エンジンは、未抽選の番号からランダムに1つを選択すること
3. 抽選エンジンは、既に抽選された番号を再度選択しないこと
4. 抽選が開始されたとき、Bingoシステムは、react-custom-rouletteを使用してルーレット演出を表示すること
5. ルーレットが停止したとき、Bingoシステムは、当選番号を中央エリアへ大きく表示すること
6. Bingoシステムは、抽選確定時に当選番号をlocalStorageへ保存すること

### 要件4: 抽選履歴表示

**ユーザーストーリー:** 進行役として、直近の当選番号とすべての当選番号を確認したい

#### 受入基準

1. Bingoシステムは、Game画面の左ペインへ直近10件の当選番号を新しい順に表示すること
2. 当選番号が11件以上になったとき、Bingoシステムは、最も古い番号を左ペインから削除すること
3. Bingoシステムは、左ペイン下部へ「これまでの当選番号を見る」リンクを表示すること
4. 「これまでの当選番号を見る」リンクがクリックされたとき、Bingoシステムは、すべての当選番号を一覧表示するモーダルを表示すること

### 要件5: 景品管理と表示

**ユーザーストーリー:** 進行役として、景品の一覧を確認し、当選状態を管理したい

#### 受入基準

1. Bingoシステムは、Game画面の右ペインへ景品一覧を表示すること
2. Bingoシステムは、各景品行へ賞名、商品名または画像サムネイル、当選状態を表示すること
3. 景品が当選済みになったとき、Bingoシステムは、その景品行へ取消線を表示すること
4. Bingoシステムは、各景品行へ当選状態を切り替えるボタンを表示すること
5. 当選状態切り替えボタンがクリックされたとき、Bingoシステムは、景品の当選状態を更新してlocalStorageへ保存すること

### 要件6: 景品設定とCSV管理

**ユーザーストーリー:** 進行役として、景品情報を編集・並び替え・一括操作したい

#### 受入基準

1. Bingoシステムは、Setting画面で景品情報をテーブル形式で表示すること
2. Bingoシステムは、CSS GridまたはFlexboxを使用してテーブルレイアウトを実現すること（HTMLのtable要素は使用しない）
3. Bingoシステムは、各景品行へ賞名、画像パス、商品名、選出状態、削除ボタンを表示すること
4. Bingoシステムは、DNDContext（@dnd-kit/core）を使用して景品行のドラッグ＆ドロップ並び替えを可能にすること
5. 景品行がドラッグ＆ドロップされたとき、Bingoシステムは、景品の表示順序を更新してlocalStorageへ保存すること
6. Bingoシステムは、CSV形式での景品一括追加機能を提供すること
7. 一括削除ボタンがクリックされたとき、Bingoシステムは、確認ダイアログを表示すること
8. 確認ダイアログで削除が承認されたとき、Bingoシステムは、すべての景品を削除してlocalStorageを更新すること

### 要件7: データ永続化

**ユーザーストーリー:** 進行役として、ブラウザを閉じても進行状況を保持したい

#### 受入基準

1. Bingoシステムは、ゲーム状態をlocalStorageへ保存すること
2. Bingoシステムは、抽選済みビンゴ番号一覧をlocalStorageへ保存すること
3. Bingoシステムは、景品の当選状態をlocalStorageへ保存すること
4. Bingoシステムは、BGM設定をlocalStorageへ保存すること
5. 状態が変更されたとき、Bingoシステムは、即座にlocalStorageを更新すること

### 要件8: ルーティングとナビゲーション

**ユーザーストーリー:** 進行役として、画面間をスムーズに移動したい

#### 受入基準

1. Bingoシステムは、React Router v7を使用してルーティングを実装すること
2. Bingoシステムは、Start画面を「/」または「/start」パスで提供すること
3. Bingoシステムは、Game画面を「/game」パスで提供すること
4. Bingoシステムは、Setting画面を「/setting」パスで提供すること
5. Bingoシステムは、各route.tsxファイルへloader、action、default export componentのみを記述すること

### 要件9: オフライン動作

**ユーザーストーリー:** 進行役として、ネットワーク接続なしでアプリケーションを使用したい

#### 受入基準

1. Bingoシステムは、ローカル環境のみで完全に動作すること
2. Bingoシステムは、外部APIやネットワーク通信へ依存しないこと
3. Bingoシステムは、すべてのアセット（画像、BGM、CSS、JavaScript）をローカルへ配置すること

### 要件10: UI/UXとデザイン

**ユーザーストーリー:** 進行役として、直感的で操作しやすいインターフェースを使用したい

#### 受入基準

1. Bingoシステムは、docs/design配下のデザイン画像に従ってUIを実装すること
2. Bingoシステムは、誤操作防止のため確認ダイアログを適切に表示すること
3. Bingoシステムは、抽選中は抽選ボタンを無効化すること
4. Bingoシステムは、プロジェクタ投影または大型ディスプレイ表示へ適したレイアウトを提供すること
5. Bingoシステムは、@mui/icons-materialを使用してアイコンを表示すること
